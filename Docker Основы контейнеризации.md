 tags: [tools, docker, devops, virtualization, interviewprep]  
alias: [Docker, Контейнеры, Образы, Докер]  
related: [[CI/CD]], [[Git]], [[Testing]]

**Docker** — это открытая платформа для разработки, доставки и запуска приложений внутри **контейнеров**.

> **Главная проблема, которую решает Docker**: "Но у меня на машине все работало!". Docker гарантирует, что ваше приложение будет работать одинаково в любой среде — на ноутбуке разработчика, на тестовом сервере или в "облаке".

**Основная аналогия**: Морской грузовой контейнер. Неважно, что внутри — бананы, электроника или автомобили. Стандартный контейнер можно перевозить на любом корабле, поезде или грузовике. Docker-контейнер так же "упаковывает" ваше приложение со **всеми его зависимостями** (код, среда выполнения, системные библиотеки, настройки) в один стандартный, переносимый блок.

### [[Образ (Image)]] vs. [[Контейнер (Container)]]

Это два самых фундаментальных понятия в Docker.

#### Образ (Image)

- **Что это?** Шаблон, "чертеж" или рецепт для создания контейнера.
    
- **Характеристики**: Образ **неизменяем (read-only)**. Он состоит из набора слоев (layers), где каждый слой — это результат выполнения одной из команд в Dockerfile.
    
- **Аналогия**: Класс в [[Объектно-ориентированное программирование в Python (ООП)|ООП]] или загрузочный диск с операционной системой.
    
- **Создается из**: Dockerfile.
    

#### Контейнер (Container)

- **Что это?** Запущенный, работающий экземпляр образа.
    
- **Характеристики**: Контейнер **изолирован** от основной системы и других контейнеров. У него своя файловая система, свои процессы и своя сеть. Он легковесный и "эфемерный" (его можно легко удалить и создать заново).
    
- **Аналогия**: Объект, созданный из класса, или работающий компьютер, запущенный с загрузочного диска.
    

---

### Dockerfile: Рецепт для создания образа

Dockerfile — это текстовый файл, содержащий пошаговую инструкцию по сборке Docker-образа.

**Пример Dockerfile для простого Python-приложения:**

```dockerfile
# 1. Выбираем базовый образ. Начинаем с официального образа Python.
FROM python:3.9-slim

# 2. Устанавливаем рабочую директорию внутри контейнера.
WORKDIR /app

# 3. Копируем файлы зависимостей в контейнер.
COPY requirements.txt .

# 4. Устанавливаем зависимости. Эта команда выполняется ОДИН РАЗ при сборке образа.
RUN pip install --no-cache-dir -r requirements.txt

# 5. Копируем остальной код нашего приложения.
COPY . .

# 6. Указываем команду, которая будет запущена при СТАРТЕ контейнера.
CMD ["python", "app.py"]
```

- RUN выполняется во время docker build.
    
- CMD выполняется во время docker run


### [[Docker Compose]]: Управление многоконтейнерными приложениями

Когда ваше приложение состоит из нескольких сервисов (например, веб-сервер, база данных, кэш), управлять ими по отдельности неудобно. Docker Compose — это инструмент для определения и запуска многоконтейнерных приложений с помощью одного YAML-файла.

**Пример docker-compose.yml:**

```yaml
version: '3.8' # Версия синтаксиса

services: # Определяем наши сервисы
  web: # Наш веб-сервер
    build: . # Указываем собрать образ из Dockerfile в текущей директории
    ports:
      - "8000:5000" # Пробрасываем порт 5000 контейнера на порт 8000 хост-машины

  redis: # Сервис для кэша
    image: "redis:alpine" # Используем готовый образ из Docker Hub
```


**Основные команды:**

- docker-compose up: Собирает (если нужно) и запускает все сервисы.
    
- docker-compose down: Останавливает и удаляет все контейнеры, сети, созданные up.
    

---

### Базовые команды Docker

|   |   |
|---|---|
|Команда|Что делает|
|docker build -t my-app .|Собрать образ из Dockerfile в текущей папке и дать ему имя my-app|
|docker run -p 80:80 my-app|Запустить контейнер из образа my-app и пробросить порт 80|
|docker ps|Показать все **запущенные** контейнеры|
|docker ps -a|Показать **все** контейнеры (включая остановленные)|
|docker images|Показать все скачанные/собранные образы на машине|
|docker stop [container_id]|Остановить работающий контейнер|
|docker rm [container_id]|Удалить остановленный контейнер|
|docker rmi [image_id]|Удалить образ|
|docker logs [container_id]|Посмотреть логи (стандартный вывод) контейнера|

---

### Популярные вопросы на собеседовании

- **"В чем разница между образом и контейнером?"**
    
- **"Какую проблему решает Docker?"**
    
- **"Зачем нужен Docker Compose?"**
    
    - Ответ: Для удобного управления многосервисными приложениями в среде разработки, чтобы одной командой поднимать все необходимое окружение (веб-сервер, БД, кэш и т.д.).
        
- **"В чем разница между RUN и CMD в Dockerfile?"**
    
    - Ответ: RUN выполняет команду на этапе **сборки образа** для установки ПО или зависимостей. CMD задает команду по умолчанию, которая выполняется на этапе **запуска контейнера**.
        
- **"Чем Docker-контейнер отличается от виртуальной машины?"**
    
    - Ответ: Виртуальная машина (ВМ) эмулирует целую операционную систему, включая ее ядро. Она тяжеловесная и медленно запускается. Docker-контейнер виртуализирует только пользовательское пространство и использует ядро хост-системы. Он гораздо легче, быстрее и потребляет меньше ресурсов.